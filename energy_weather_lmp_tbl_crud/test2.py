import json
import boto3
from boto3.dynamodb.conditions import Key
from decimal import Decimal
ddb = boto3.resource('dynamodb')
table = ddb.Table('energy_weather_lmp')

def json_response(data, response_code=200):
    return json.dumps(data), response_code, {'Content-Type': 'application/json'}

def insert_ddb_table(payload):
    response = table.put_item(Item=payload)
    return response

def update_ddb_table(payload, payload_type, load_area, occ_date):
    
    response = table.update_item(
        Key={
            'load_area_id': load_area,
            'occurance_date': occ_date
        },
        UpdateExpression="set "+payload_type+"=:info",
        ExpressionAttributeValues={
            ':info': payload
        },
        ReturnValues="UPDATED_NEW"
    )
    return response
    
def parse_float_to_decimal(event_record):
    parsed_event_record = json.loads(json.dumps(event_record), parse_float=Decimal)
    return parsed_event_record

def prep_payload(event_record, payload_type):
    # first convert everything to string
    for dicts in event_record:
        if isinstance(event_record[dicts],str) == 0:
            event_record[dicts] = str(event_record[dicts])
    # parsed_event_record = parse_float_to_decimal(event_record)
    
    # payload becomes nested dictionary with payload_type as key 
    payload = {payload_type: event_record}
    # extracts the load_area and date into top level of dictionary
    payload['load_area_id'] = payload[payload_type]['load_area']
    payload['occurance_date'] = payload[payload_type]['datetime_beginning_utc']
    return payload

# def lambda_handler(event, context):
 # parse out event parameters
 
event = [{"datetime_beginning_utc": 1609459200, "system_energy_price_da": 24.62, "total_lmp_da": 24.29, "congestion_price_da": 0.3, "marginal_loss_price_da": -0.63, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609462800, "system_energy_price_da": 23.23, "total_lmp_da": 22.83, "congestion_price_da": 0.18, "marginal_loss_price_da": -0.58, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609466400, "system_energy_price_da": 21.69, "total_lmp_da": 21.13, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.56, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609470000, "system_energy_price_da": 20.0, "total_lmp_da": 19.49, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.51, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609473600, "system_energy_price_da": 18.77, "total_lmp_da": 18.28, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.49, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609477200, "system_energy_price_da": 19.29, "total_lmp_da": 18.89, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.4, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609480800, "system_energy_price_da": 17.89, "total_lmp_da": 17.49, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.4, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609484400, "system_energy_price_da": 17.82, "total_lmp_da": 17.47, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.35, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609488000, "system_energy_price_da": 17.8, "total_lmp_da": 17.45, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.35, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609491600, "system_energy_price_da": 17.88, "total_lmp_da": 17.5, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.38, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609495200, "system_energy_price_da": 17.99, "total_lmp_da": 17.64, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.35, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609498800, "system_energy_price_da": 17.97, "total_lmp_da": 17.55, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.42, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609502400, "system_energy_price_da": 18.88, "total_lmp_da": 18.47, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.41, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609506000, "system_energy_price_da": 19.41, "total_lmp_da": 18.99, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.42, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609509600, "system_energy_price_da": 21.13, "total_lmp_da": 20.68, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.45, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609513200, "system_energy_price_da": 21.03, "total_lmp_da": 20.6, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.43, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609516800, "system_energy_price_da": 21.0, "total_lmp_da": 20.56, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.44, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609520400, "system_energy_price_da": 20.59, "total_lmp_da": 20.18, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.41, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609524000, "system_energy_price_da": 19.79, "total_lmp_da": 19.51, "congestion_price_da": 0.09, "marginal_loss_price_da": -0.38, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609527600, "system_energy_price_da": 19.39, "total_lmp_da": 19.13, "congestion_price_da": 0.11, "marginal_loss_price_da": -0.37, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609531200, "system_energy_price_da": 18.94, "total_lmp_da": 18.87, "congestion_price_da": 0.29, "marginal_loss_price_da": -0.37, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609534800, "system_energy_price_da": 21.15, "total_lmp_da": 21.09, "congestion_price_da": 0.33, "marginal_loss_price_da": -0.39, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609538400, "system_energy_price_da": 23.76, "total_lmp_da": 23.05, "congestion_price_da": -0.22, "marginal_loss_price_da": -0.49, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609542000, "system_energy_price_da": 23.49, "total_lmp_da": 23.04, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.45, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609545600, "system_energy_price_da": 22.2, "total_lmp_da": 21.78, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.42, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609549200, "system_energy_price_da": 22.16, "total_lmp_da": 21.76, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.4, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609552800, "system_energy_price_da": 19.96, "total_lmp_da": 19.6, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.36, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609556400, "system_energy_price_da": 17.86, "total_lmp_da": 17.5, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.36, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609560000, "system_energy_price_da": 17.07, "total_lmp_da": 16.76, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.31, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609563600, "system_energy_price_da": 16.99, "total_lmp_da": 16.77, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.22, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609567200, "system_energy_price_da": 17.01, "total_lmp_da": 16.82, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.19, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609570800, "system_energy_price_da": 16.61, "total_lmp_da": 16.42, "congestion_price_da": 0.01, "marginal_loss_price_da": -0.2, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609574400, "system_energy_price_da": 16.09, "total_lmp_da": 15.88, "congestion_ rice_da": 0.0, "marginal_loss_price_da": -0.21, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609578000, "system_energy_price_da": 16.33, "total_lmp_da": 16.12, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.21, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609581600, "system_energy_price_da": 16.65, "total_lmp_da": 16.45, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.2, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609585200, "system_energy_price_da": 17.14, "total_lmp_da": 16.95, "congestion_price_da": 0.03, "marginal_loss_price_da": -0.22, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609588800, "system_energy_price_da": 18.65, "total_lmp_da": 18.44, "congestion_price_da": 0.02, "marginal_loss_price_da": -0.23, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609592400, "system_energy_price_da": 19.69, "total_lmp_da": 19.46, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.23, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609596000, "system_energy_price_da": 21.27, "total_lmp_da": 21.0, "congestion_price_da": 0.01, "marginal_loss_price_da": -0.28, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609599600, "system_energy_price_da": 21.8, "total_lmp_da": 21.7, "congestion_price_da": 0.14, "marginal_loss_price_da": -0.24, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609603200, "system_energy_price_da": 21.28, "total_lmp_da": 22.05, "congestion_price_da": 0.98, "marginal_loss_price_da": -0.21, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609606800, "system_energy_price_da": 19.62, "total_lmp_da": 19.58, "congestion_price_da": 0.13, "marginal_loss_price_da": -0.17, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609610400, "system_energy_price_da": 18.97, "total_lmp_da": 18.93, "congestion_price_da": 0.14, "marginal_loss_price_da": -0.18, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609614000, "system_energy_price_da": 18.42, "total_lmp_da": 18.41, "congestion_price_da": 0.17, "marginal_loss_price_da": -0.18, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609617600, "system_energy_price_da": 18.73, "total_lmp_da": 18.7, "congestion_price_da": 0.13, "marginal_loss_price_da": -0.16, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609621200, "system_energy_price_da": 20.87, "total_lmp_da": 20.75, "congestion_price_da": 0.08, "marginal_loss_price_da": -0.2, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609624800, "system_energy_price_da": 23.99, "total_lmp_da": 23.74, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.25, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609628400, "system_energy_price_da": 23.7, "total_lmp_da": 23.41, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.29, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609632000, "system_energy_price_da": 23.04, "total_lmp_da": 22.81, "congestion_price_da": 0.06, "marginal_loss_price_da": -0.29, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609635600, "system_energy_price_da": 22.39, "total_lmp_da": 22.17, "congestion_price_da": 0.06, "marginal_loss_price_da": -0.28, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609639200, "system_energy_price_da": 21.51, "total_lmp_da": 21.36, "congestion_price_da": 0.11, "marginal_loss_price_da": -0.26, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609642800, "system_energy_price_da": 20.01, "total_lmp_da": 19.9, "congestion_price_da": 0.1, "marginal_loss_price_da": -0.21, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609646400, "system_energy_price_da": 18.59, "total_lmp_da": 18.43, "congestion_price_da": 0.03, "marginal_loss_price_da": -0.19, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609650000, "system_energy_price_da": 18.74, "total_lmp_da": 18.44, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.3, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609653600, "system_energy_price_da": 17.5, "total_lmp_da": 17.2, "congestion_price_da": 0.01, "marginal_loss_price_da": -0.31, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609657200, "system_energy_price_da": 17.07, "total_lmp_da": 16.85, "congestion_price_da": 0.03, "marginal_loss_price_da": -0.25, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609660800, "system_energy_price_da": 17.09, "total_lmp_da": 16.88, "congestion_price_da": 0.05, "marginal_loss_price_da": -0.26, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609664400, "system_energy_price_da": 17.13, "total_lmp_da": 16.93, "congestion_price_da": 0.05, "marginal_loss_price_da": -0.25, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609668000, "system_energy_price_da": 17.02, "total_lmp_da": 16.84, "congestion_price_da": 0.08, "marginal_loss_price_da": -0.26, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609671600, "system_energy_price_da": 17.35, "total_lmp_da": 17.1, "congestion_price_da": 0.05, "marginal_loss_price_da": -0.3, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609675200, "system_energy_price_da": 18.52, "total_lmp_da": 18.17, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.35, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609678800, "system_energy_price_da": 20.46, "total_lmp_da": 20.1, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.36, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609682400, "system_energy_price_da": 21.02, "total_lmp_da": 20.7, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.32, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609686000, "system_energy_price_da": 21.88, "total_lmp_da": 21.57, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.31, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609689600, "system_energy_price_da": 22.29, "total_lmp_da": 22.0, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.29, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609693200, "system_energy_price_da": 21.81, "total_lmp_da": 21.53, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.28, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609696800, "system_energy_price_da": 21.54, "total_lmp_da": 21.29, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.25, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609700400, "system_energy_price_da": 21.24, "total_lmp_da": 21.0, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.24, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609704000, "system_energy_price_da": 21.42, "total_lmp_da": 21.2, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.22, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609707600, "system_energy_price_da": 23.38, "total_lmp_da": 23.13, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.25, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609711200, "system_energy_price_da": 26.16, "total_lmp_da": 25.8, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.36, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609714800, "system_energy_price_da": 24.5, "total_lmp_da": 24.17, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.33, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609718400, "system_energy_price_da": 23.76, "total_lmp_da": 23.46, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.3, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609722000, "system_energy_price_da": 23.22, "total_lmp_da": 22.93, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.29, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609725600, "system_energy_price_da": 22.48, "total_lmp_da": 22.19, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.29, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609729200, "system_energy_price_da": 20.74, "total_lmp_da": 20.36, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.38, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609732800, "system_energy_price_da": 19.81, "total_lmp_da": 19.58, "congestion_price_da": 0.13, "marginal_loss_price_da": -0.36, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609736400, "system_energy_price_da": 19.07, "total_lmp_da": 18.69, "congestion_price_da": 0.03, "marginal_loss_price_da": -0.41, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609740000, "system_energy_price_da": 18.56, "total_lmp_da": 18.16, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.4, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609743600, "system_energy_price_da": 18.51, "total_lmp_da": 18.14, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.37, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609747200, "system_energy_price_da": 18.57, "total_lmp_da": 18.19, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.38, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609750800, "system_energy_price_da": 18.97, "total_lmp_da": 18.56, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.41, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609754400, "system_energy_price_da": 20.38, "total_lmp_da": 20.0, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.38, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609758000, "system_energy_price_da": 26.09, "total_lmp_da": 25.55, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.54, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609761600, "system_energy_price_da": 31.47, "total_lmp_da": 30.87, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.6, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609765200, "system_energy_price_da": 27.0, "total_lmp_da": 26.49, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.51, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609768800, "system_energy_price_da": 26.83, "total_lmp_da": 26.4, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.43, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609772400, "system_energy_price_da": 26.78, "total_lmp_da": 26.37, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.41, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609776000, "system_energy_price_da": 24.91, "total_lmp_da": 24.56, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.35, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609779600, "system_energy_price_da": 23.25, "total_lmp_da": 22.95, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.3, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609783200, "system_energy_price_da": 22.61, "total_lmp_da": 22.31, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.3, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609786800, "system_energy_price_da": 22.5, "total_lmp_da": 22.2, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.3, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609790400, "system_energy_price_da": 22.61, "total_lmp_da": 22.32, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.29, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609794000, "system_energy_price_da": 23.32, "total_lmp_da": 22.97, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.35, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609797600, "system_energy_price_da": 29.71, "total_lmp_da": 29.23, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.48, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609801200, "system_energy_price_da": 27.29, "total_lmp_da": 26.84, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.45, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609804800, "system_energy_price_da": 26.52, "total_lmp_da": 26.07, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.45, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609808400, "system_energy_price_da": 24.72, "total_lmp_da": 24.29, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.43, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609812000, "system_energy_price_da": 23.2, "total_lmp_da": 22.82, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.38, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609815600, "system_energy_price_da": 21.7, "total_lmp_da": 21.32, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.38, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609819200, "system_energy_price_da": 19.74, "total_lmp_da": 19.34, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.4, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609822800, "system_energy_price_da": 20.6, "total_lmp_da": 20.21, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.39, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609826400, "system_energy_price_da": 19.82, "total_lmp_da": 19.47, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.35, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609830000, "system_energy_price_da": 19.7, "total_lmp_da": 19.35, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.35, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609833600, "system_energy_price_da": 19.5, "total_lmp_da": 19.15, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.35, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609837200, "system_energy_price_da": 19.76, "total_lmp_da": 19.38, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.38, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609840800, "system_energy_price_da": 22.25, "total_lmp_da": 21.79, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.46, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609844400, "system_energy_price_da": 32.31, "total_lmp_da": 31.68, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.63, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609848000, "system_energy_price_da": 35.33, "total_lmp_da": 34.72, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.61, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609851600, "system_energy_price_da": 32.51, "total_lmp_da": 32.11, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.4, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609855200, "system_energy_price_da": 31.59, "total_lmp_da": 31.27, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.32, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609858800, "system_energy_price_da": 32.57, "total_lmp_da": 32.15, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.42, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609862400, "system_energy_price_da": 31.72, "total_lmp_da": 31.37, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.35, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609866000, "system_energy_price_da": 28.17, "total_lmp_da": 27.91, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.26, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609869600, "system_energy_price_da": 26.77, "total_lmp_da": 26.55, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.22, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609873200, "system_energy_price_da": 26.0, "total_lmp_da": 25.78, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.22, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609876800, "system_energy_price_da": 25.89, "total_lmp_da": 25.66, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.23, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609880400, "system_energy_price_da": 27.51, "total_lmp_da": 27.22, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.29, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609884000, "system_energy_price_da": 38.98, "total_lmp_da": 38.5, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.48, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609887600, "system_energy_price_da": 33.25, "total_lmp_da": 32.83, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.42, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609891200, "system_energy_price_da": 31.13, "total_lmp_da": 30.73, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.4, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609894800, "system_energy_price_da": 32.01, "total_lmp_da": 31.6, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.41, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609898400, "system_energy_price_da": 28.16, "total_lmp_da": 27.78, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.38, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609902000, "system_energy_price_da": 24.48, "total_lmp_da": 24.15, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.33, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609905600, "system_energy_price_da": 22.56, "total_lmp_da": 22.19, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.37, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609909200, "system_energy_price_da": 22.89, "total_lmp_da": 22.48, "congestion_price_da": 0.03, "marginal_loss_price_da": -0.44, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609912800, "system_energy_price_da": 22.4, "total_lmp_da": 21.98, "congestion_price_da": 0.03, "marginal_loss_price_da": -0.45, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609916400, "system_energy_price_da": 21.8, "total_lmp_da": 21.38, "congestion_price_da": 0.03, "marginal_loss_price_da": -0.45, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609920000, "system_energy_price_da": 21.89, "total_lmp_da": 21.47, "congestion_price_da": 0.04, "marginal_loss_price_da": -0.46, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609923600, "system_energy_price_da": 22.75, "total_lmp_da": 22.33, "congestion_price_da": 0.04, "marginal_loss_price_da": -0.46, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609927200, "system_energy_price_da": 24.29, "total_lmp_da": 23.86, "congestion_price_da": 0.04, "marginal_loss_price_da": -0.47, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609930800, "system_energy_price_da": 32.67, "total_lmp_da": 32.28, "congestion_price_da": 0.06, "marginal_loss_price_da": -0.45, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609934400, "system_energy_price_da": 41.94, "total_lmp_da": 41.55, "congestion_price_da": 0.11, "marginal_loss_price_da": -0.5, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609938000, "system_energy_price_da": 36.2, "total_lmp_da": 40.14, "congestion_price_da": 4.28, "marginal_loss_price_da": -0.34, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609941600, "system_energy_price_da": 30.16, "total_lmp_da": 35.94, "congestion_price_da": 6.01, "marginal_loss_price_da": -0.23, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609945200, "system_energy_price_da": 29.21, "total_lmp_da": 34.73, "congestion_price_da": 5.74, "marginal_loss_price_da": -0.22, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609948800, "system_energy_price_da": 27.63, "total_lmp_da": 33.16, "congestion_price_da": 5.65, "marginal_loss_price_da": -0.12, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609952400, "system_energy_price_da": 24.58, "total_lmp_da": 28.77, "congestion_price_da": 4.3, "marginal_loss_price_da": -0.12, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609956000, "system_energy_price_da": 23.93, "total_lmp_da": 27.76, "congestion_price_da": 3.96, "marginal_loss_price_da": -0.13, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609959600, "system_energy_price_da": 23.86, "total_lmp_da": 26.8, "congestion_price_da": 3.11, "marginal_loss_price_da": -0.18, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609963200, "system_energy_price_da": 23.79, "total_lmp_da": 26.18, "congestion_price_da": 2.68, "marginal_loss_price_da": -0.29, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609966800, "system_energy_price_da": 26.59, "total_lmp_da": 29.88, "congestion_price_da": 3.63, "marginal_loss_price_da": -0.33, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609970400, "system_energy_price_da": 37.67, "total_lmp_da": 40.53, "congestion_price_da": 3.35, "marginal_loss_price_da": -0.48, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609974000, "system_energy_price_da": 31.9, "total_lmp_da": 35.15, "congestion_price_da": 3.69, "marginal_loss_price_da": -0.44, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609977600, "system_energy_price_da": 29.46, "total_lmp_da": 30.92, "congestion_price_da": 1.85, "marginal_loss_price_da": -0.39, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609981200, "system_energy_price_da": 27.66, "total_lmp_da": 27.79, "congestion_price_da": 0.54, "marginal_loss_price_da": -0.41, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609984800, "system_energy_price_da": 26.21, "total_lmp_da": 25.74, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.47, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609988400, "system_energy_price_da": 23.72, "total_lmp_da": 23.28, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.44, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609992000, "system_energy_price_da": 22.84, "total_lmp_da": 22.39, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.45, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609995600, "system_energy_price_da": 22.36, "total_lmp_da": 21.84, "congestion_price_da": -0.06, "marginal_loss_price_da": -0.46, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1609999200, "system_energy_price_da": 21.33, "total_lmp_da": 20.89, "congestion_price_da": 0.03, "marginal_loss_price_da": -0.47, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610002800, "system_energy_price_da": 20.72, "total_lmp_da": 20.28, "congestion_price_da": 0.02, "marginal_loss_price_da": -0.46, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610006400, "system_energy_price_da": 20.81, "total_lmp_da": 20.36, "congestion_price_da": 0.02, "marginal_loss_price_da": -0.47, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610010000, "system_energy_price_da": 22.19, "total_lmp_da": 21.73, "congestion_price_da": 0.03, "marginal_loss_price_da": -0.49, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610013600, "system_energy_price_da": 23.08, "total_lmp_da": 22.61, "congestion_price_da": 0.04, "marginal_loss_price_da": -0.51, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610017200, "system_energy_price_da": 27.59, "total_lmp_da": 27.08, "congestion_price_da": -0.16, "marginal_loss_price_da": -0.35, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610020800, "system_energy_price_da": 38.72, "total_lmp_da": 37.91, "congestion_price_da": -0.18, "marginal_loss_price_da": -0.63, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610024400, "system_energy_price_da": 30.67, "total_lmp_da": 30.22, "congestion_price_da": 0.05, "marginal_loss_price_da": -0.5, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610028000, "system_energy_price_da": 26.55, "total_lmp_da": 26.25, "congestion_price_da": 0.02, "marginal_loss_price_da": -0.32, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610031600, "system_energy_price_da": 25.97, "total_lmp_da": 25.62, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.35, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610035200, "system_energy_price_da": 25.23, "total_lmp_da": 24.98, "congestion_price_da": 0.05, "marginal_loss_price_da": -0.3, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610038800, "system_energy_price_da": 23.37, "total_lmp_da": 23.15, "congestion_price_da": 0.05, "marginal_loss_price_da": -0.27, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610042400, "system_energy_price_da": 22.84, "total_lmp_da": 22.68, "congestion_price_da": 0.05, "marginal_loss_price_da": -0.21, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610046000, "system_energy_price_da": 22.67, "total_lmp_da": 22.49, "congestion_price_da": 0.05, "marginal_loss_price_da": -0.23, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610049600, "system_energy_price_da": 22.7, "total_lmp_da": 22.5, "congestion_price_da": 0.05, "marginal_loss_price_da": -0.25, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610053200, "system_energy_price_da": 24.61, "total_lmp_da": 24.3, "congestion_price_da": 0.03, "marginal_loss_price_da": -0.34, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610056800, "system_energy_price_da": 32.37, "total_lmp_da": 31.86, "congestion_price_da": 0.03, "marginal_loss_price_da": -0.54, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610060400, "system_energy_price_da": 29.29, "total_lmp_da": 28.8, "congestion_price_da": 0.07, "marginal_loss_price_da": -0.56, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610064000, "system_energy_price_da": 28.76, "total_lmp_da": 28.25, "congestion_price_da": 0.06, "marginal_loss_price_da": -0.57, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610067600, "system_energy_price_da": 28.71, "total_lmp_da": 28.14, "congestion_price_da": 0.06, "marginal_loss_price_da": -0.63, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610071200, "system_energy_price_da": 26.82, "total_lmp_da": 26.33, "congestion_price_da": 0.03, "marginal_loss_price_da": -0.52, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610074800, "system_energy_price_da": 24.24, "total_lmp_da": 23.84, "congestion_price_da": 0.05, "marginal_loss_price_da": -0.45, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610078400, "system_energy_price_da": 22.15, "total_lmp_da": 21.74, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.41, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610082000, "system_energy_price_da": 23.05, "total_lmp_da": 22.65, "congestion_price_da": 0.04, "marginal_loss_price_da": -0.44, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610085600, "system_energy_price_da": 22.25, "total_lmp_da": 21.84, "congestion_price_da": 0.06, "marginal_loss_price_da": -0.47, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610089200, "system_energy_price_da": 21.8, "total_lmp_da": 21.41, "congestion_price_da": 0.06, "marginal_loss_price_da": -0.45, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610092800, "system_energy_price_da": 21.79, "total_lmp_da": 21.39, "congestion_price_da": 0.06, "marginal_loss_price_da": -0.46, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610096400, "system_energy_price_da": 22.44, "total_lmp_da": 22.02, "congestion_price_da": 0.06, "marginal_loss_price_da": -0.48, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610100000, "system_energy_price_da": 23.64, "total_lmp_da": 23.23, "congestion_price_da": 0.06, "marginal_loss_price_da": -0.47, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610103600, "system_energy_price_da": 33.05, "total_lmp_da": 31.97, "congestion_price_da": -0.42, "marginal_loss_price_da": -0.66, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610107200, "system_energy_price_da": 41.12, "total_lmp_da": 37.1, "congestion_price_da": -3.38, "marginal_loss_price_da": -0.64, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610110800, "system_energy_price_da": 39.05, "total_lmp_da": 37.42, "congestion_price_da": -1.1, "marginal_loss_price_da": -0.52, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610114400, "system_energy_price_da": 33.04, "total_lmp_da": 32.47, "congestion_price_da": -0.17, "marginal_loss_price_da": -0.4, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610118000, "system_energy_price_da": 33.0, "total_lmp_da": 32.51, "congestion_price_da": -0.15, "marginal_loss_price_da": -0.34, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610121600, "system_energy_price_da": 32.19, "total_lmp_da": 31.88, "congestion_price_da": -0.03, "marginal_loss_price_da": -0.29, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610125200, "system_energy_price_da": 28.36, "total_lmp_da": 28.04, "congestion_price_da": -0.09, "marginal_loss_price_da": -0.23, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610128800, "system_energy_price_da": 26.58, "total_lmp_da": 26.29, "congestion_price_da": -0.1, "marginal_loss_price_da": -0.19, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610132400, "system_energy_price_da": 25.85, "total_lmp_da": 25.52, "congestion_price_da": -0.12, "marginal_loss_price_da": -0.2, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610136000, "system_energy_price_da": 25.57, "total_lmp_da": 25.33, "congestion_price_da": -0.02, "marginal_loss_price_da": -0.22, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610139600, "system_energy_price_da": 29.39, "total_lmp_da": 29.01, "congestion_price_da": -0.08, "marginal_loss_price_da": -0.3, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610143200, "system_energy_price_da": 37.64, "total_lmp_da": 37.1, "congestion_price_da": -0.12, "marginal_loss_price_da": -0.42, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610146800, "system_energy_price_da": 31.64, "total_lmp_da": 31.15, "congestion_price_da": -0.09, "marginal_loss_price_da": -0.4, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610150400, "system_energy_price_da": 29.69, "total_lmp_da": 29.23, "congestion_price_da": -0.04, "marginal_loss_price_da": -0.42, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610154000, "system_energy_price_da": 29.41, "total_lmp_da": 28.97, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.44, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610157600, "system_energy_price_da": 26.53, "total_lmp_da": 26.12, "congestion_price_da": 0.04, "marginal_loss_price_da": -0.45, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610161200, "system_energy_price_da": 25.11, "total_lmp_da": 24.72, "congestion_price_da": 0.04, "marginal_loss_price_da": -0.43, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610164800, "system_energy_price_da": 23.62, "total_lmp_da": 23.21, "congestion_price_da": 0.03, "marginal_loss_price_da": -0.44, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610168400, "system_energy_price_da": 23.25, "total_lmp_da": 22.54, "congestion_price_da": -0.19, "marginal_loss_price_da": -0.52, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610172000, "system_energy_price_da": 22.53, "total_lmp_da": 22.02, "congestion_price_da": 0.03, "marginal_loss_price_da": -0.54, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610175600, "system_energy_price_da": 21.67, "total_lmp_da": 21.02, "congestion_price_da": -0.13, "marginal_loss_price_da": -0.52, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610179200, "system_energy_price_da": 22.14, "total_lmp_da": 21.32, "congestion_price_da": -0.28, "marginal_loss_price_da": -0.54, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610182800, "system_energy_price_da": 22.47, "total_lmp_da": 21.75, "congestion_price_da": -0.19, "marginal_loss_price_da": -0.53, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610186400, "system_energy_price_da": 23.1, "total_lmp_da": 22.25, "congestion_price_da": -0.27, "marginal_loss_price_da": -0.57, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610190000, "system_energy_price_da": 25.1, "total_lmp_da": 23.03, "congestion_price_da": -1.45, "marginal_loss_price_da": -0.62, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610193600, "system_energy_price_da": 27.1, "total_lmp_da": 25.02, "congestion_price_da": -1.55, "marginal_loss_price_da": -0.53, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610197200, "system_energy_price_da": 28.44, "total_lmp_da": 26.93, "congestion_price_da": -0.98, "marginal_loss_price_da": -0.53, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610200800, "system_energy_price_da": 27.06, "total_lmp_da": 26.09, "congestion_price_da": -0.47, "marginal_loss_price_da": -0.5, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610204400, "system_energy_price_da": 26.28, "total_lmp_da": 26.13, "congestion_price_da": 0.29, "marginal_loss_price_da": -0.44, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610208000, "system_energy_price_da": 24.31, "total_lmp_da": 24.16, "congestion_price_da": 0.25, "marginal_loss_price_da": -0.4, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610211600, "system_energy_price_da": 22.55, "total_lmp_da": 22.43, "congestion_price_da": 0.24, "marginal_loss_price_da": -0.36, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610215200, "system_energy_price_da": 22.01, "total_lmp_da": 21.91, "congestion_price_da": 0.25, "marginal_loss_price_da": -0.35, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610218800, "system_energy_price_da": 21.32, "total_lmp_da": 21.23, "congestion_price_da": 0.25, "marginal_loss_price_da": -0.34, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610222400, "system_energy_price_da": 21.32, "total_lmp_da": 21.23, "congestion_price_da": 0.24, "marginal_loss_price_da": -0.33, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610226000, "system_energy_price_da": 23.01, "total_lmp_da": 22.85, "congestion_price_da": 0.24, "marginal_loss_price_da": -0.4, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610229600, "system_energy_price_da": 29.65, "total_lmp_da": 27.77, "congestion_price_da": -1.35, "marginal_loss_price_da": -0.53, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610233200, "system_energy_price_da": 28.63, "total_lmp_da": 27.33, "congestion_price_da": -0.76, "marginal_loss_price_da": -0.54, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610236800, "system_energy_price_da": 27.2, "total_lmp_da": 26.1, "congestion_price_da": -0.58, "marginal_loss_price_da": -0.52, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610240400, "system_energy_price_da": 26.76, "total_lmp_da": 25.68, "congestion_price_da": -0.57, "marginal_loss_price_da": -0.51, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610244000, "system_energy_price_da": 25.29, "total_lmp_da": 24.42, "congestion_price_da": -0.35, "marginal_loss_price_da": -0.52, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610247600, "system_energy_price_da": 23.63, "total_lmp_da": 23.13, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.5, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610251200, "system_energy_price_da": 22.93, "total_lmp_da": 22.38, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.55, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610254800, "system_energy_price_da": 22.25, "total_lmp_da": 21.63, "congestion_price_da": -0.09, "marginal_loss_price_da": -0.54, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610258400, "system_energy_price_da": 21.62, "total_lmp_da": 21.1, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.52, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610262000, "system_energy_price_da": 21.33, "total_lmp_da": 20.79, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.54, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610265600, "system_energy_price_da": 21.51, "total_lmp_da": 20.94, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.57, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610269200, "system_energy_price_da": 21.29, "total_lmp_da": 20.74, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.55, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610272800, "system_energy_price_da": 22.74, "total_lmp_da": 22.17, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.57, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610276400, "system_energy_price_da": 24.29, "total_lmp_da": 23.64, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.65, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610280000, "system_energy_price_da": 26.87, "total_lmp_da": 25.95, "congestion_price_da": -0.21, "marginal_loss_price_da": -0.71, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610283600, "system_energy_price_da": 26.17, "total_lmp_da": 25.41, "congestion_price_da": -0.09, "marginal_loss_price_da": -0.67, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610287200, "system_energy_price_da": 24.27, "total_lmp_da": 23.52, "congestion_price_da": -0.12, "marginal_loss_price_da": -0.63, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610290800, "system_energy_price_da": 23.19, "total_lmp_da": 22.6, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.59, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610294400, "system_energy_price_da": 22.3, "total_lmp_da": 21.81, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.49, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610298000, "system_energy_price_da": 21.9, "total_lmp_da": 21.42, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.48, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610301600, "system_energy_price_da": 20.86, "total_lmp_da": 20.41, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.45, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610305200, "system_energy_price_da": 20.35, "total_lmp_da": 19.92, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.43, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610308800, "system_energy_price_da": 20.63, "total_lmp_da": 20.18, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.45, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610312400, "system_energy_price_da": 23.07, "total_lmp_da": 22.56, "congestion_price_da": 0.0, "marginal_loss_price_da": -0.51, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610316000, "system_energy_price_da": 29.34, "total_lmp_da": 27.31, "congestion_price_da": -1.38, "marginal_loss_price_da": -0.65, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}, {"datetime_beginning_utc": 1610319600, "system_energy_price_da": 28.59, "total_lmp_da": 26.62, "congestion_price_da": -1.21, "marginal_loss_price_da": -0.76, "load_area": "DUQ", "action_type": "UPDATE", "data_product": "da_hrl_lmps"}]
# event = json.dumps(json_data)
 
for record in event:
    action_type = record.pop('action_type')
    if action_type == 'PUT':
        payload_type = record.pop('data_product')
        # at this point both action_type an payload_type have been popped from event.
        payload = prep_payload(record, payload_type)
        result = insert_ddb_table(payload)
    else:
        payload_type = record.pop('data_product')
        payload = parse_float_to_decimal(record)
        load_area = payload['load_area']
        occ_date = payload['datetime_beginning_utc']
        result = update_ddb_table(payload, payload_type, load_area, occ_date)
    # else:
    #     return {
    #         "statusCode": 200,
    #         "body": json.dumps({
    #             "message": "No Action Defined",
    #             # "location": ip.text.replace("\n", "")
    #         }),
    #     }




